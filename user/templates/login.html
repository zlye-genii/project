<!DOCTYPE html>
<html>
<head>
    <title>Login and Registration Form</title>
</head>
<body>
    <h2>Registration Form</h2>
    <form id="registrationForm" action="/api/user/registration/" method="post">
      {% csrf_token %}
        <label for="username">Username:</label><br>
        <input type="text" id="username" name="username"><br>
        <label for="email">Email:</label><br>
        <input type="email" id="email" name="email"><br>
        <label for="password1">Password:</label><br>
        <input type="password" id="password1" name="password1"><br>
        <label for="password2">Confirm Password:</label><br>
        <input type="password" id="password2" name="password2"><br>
        <input type="submit" value="Register">
    </form>

    <h2>Login Form</h2>
    <form id="loginForm" action="/api/user/login/" method="post">
      {% csrf_token %}
        <label for="login_username">Username:</label><br>
        <input type="text" id="login_username" name="username"><br>
        <label for="login_password">Password:</label><br>
        <input type="password" id="login_password" name="password"><br>
        <input type="submit" value="Login">
    </form>
    <script>
      document.getElementById('registrationForm').addEventListener('submit', function(event) {
          event.preventDefault();
          fetch('/api/user/registration/', {
              method: 'POST',
              headers: {
                  'Content-Type': 'application/json',
                  'X-CSRFToken': document.querySelector('[name=csrfmiddlewaretoken]').value
              },
              body: JSON.stringify({
                  username: document.getElementById('username').value,
                  email: document.getElementById('email').value,
                  password1: document.getElementById('password1').value,
                  password2: document.getElementById('password2').value
              })
          })
          .then(response => response.json())
          .then(data => {
              if (!data.error) {
                  window.location.href = '/user/account';
              } else {
                  // handle error
              }
          });
      });
      
      document.getElementById('loginForm').addEventListener('submit', function(event) {
          event.preventDefault();
          fetch('/api/user/login/', {
              method: 'POST',
              headers: {
                  'Content-Type': 'application/json',
                  'X-CSRFToken': document.querySelector('[name=csrfmiddlewaretoken]').value
              },
              body: JSON.stringify({
                  username: document.getElementById('login_username').value,
                  password: document.getElementById('login_password').value
              })
          })
          .then(response => response.json())
          .then(data => {
              if (!data.error) {
                  window.location.href = '/user/account';
              } else {
                  // handle error
              }
          });
      });
      </script>
</body>
</html>